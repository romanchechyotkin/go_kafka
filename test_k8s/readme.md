rewrite for kafka producers and consumers